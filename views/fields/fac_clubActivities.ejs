<%- include ("../partials/header") %>

  <div class="container-fluid">
    <section id="form">
      <form id="clubActivitiesForm" class="needs-validation" novalidate="">
        <div class="container-fluid">

          <!-- Header Section -->

          <div class="row">
            <div class="col-md-8 mb-3">
              <h4 class="mb-3 title">Club Activities Data Entry</h4>
            </div>
            <div class="col-md-4 mb-3 report">
              <a href="/faculty/search" class="btn btn-sm btn-primary shadow-sm"><i
                  class="fas fa-download fa-sm text-white-50"></i> Generate Report</a>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="required">Club Name</label>
              <select name="clubName" class="custom-select d-block w-100" id="selectBox" onChange="changeFunc();">
                <option value="">Choose...</option>
                <option>ACE</option>
                <option>MindsSpark</option>
                <option>Hakerearth</option>
                <option>CyberNauts</option>
                <option>Moziety</option>
                <option>Rise</option>
                <option>Codechef</option>
                <option>Coding Ninjas</option>
                <option>Google DSC</option>
                <option>GLUG</option>
                <option>Society of Civil Engineers</option>
                <option>ECO</option>
                <option>Electronic Technical Association (ETA)</option>
                <option>TAQ</option>
                <option> Forum for Electrical & Electronics Engineers(FEEE)</option>
                <option>ENSAV</option>
                <option>Society of Mechanical Engineers(SME)</option>
                <option>PROLAB</option>
                <option>Technolix</option>
                <option>Science Club</option>
                <option>Protocol</option>
                <option>Finance & Investment Club</option>
                <option>HR & Communication Club</option>
                <option>Marketing & Entrepreneurship Club</option>
                <option>Technotuners</option>
                <option>Rotract Club</option>
                <option>Connaissance Club</option>
                <option>GreeksForGreeks</option>
                <option value="others">Others</option>
              </select>
              <input name="clubName" placeholder="Mention Here..." class="form-control other-text" type="text"
                style="display: none" id="textboxes">
              <div class="invalid-feedback">
                Please select a valid type.
              </div>
            </div>
            <div class="col-md-6 mb-3">
              <label class="required">Topic</label>
              <input type="text" name="topic" class="form-control">
            </div>
          </div>
          <div class="row">

            <div class="col-md-6 mb-3">
              <label class="required">Resource Person</label>
              <input type="text" name="resourcePerson" class="form-control">
            </div>
            <div class="col-md-6 mb-3">
              <label class="required">Designation</label>
              <input type="text" name="designation" class="form-control">
            </div>
          </div>
          <div class="row">

            <div class="col-md-6 mb-3">
              <label class="required">Company</label>
              <input type="text" name="company" class="form-control">
            </div>
            <div class="col-md-6 mb-3">
              <label>Benefit</label>
              <input type="text" name="benefits" class="form-control">
            </div>
          </div>
          <div class="row">

            <div class="col-md-6 mb-3">
              <label>Event Objective</label>
              <input type="text" name="objective" class="form-control">
            </div>
            <div class="col-md-6 mb-3">
              <label>Website</label>
              <input type="text" name="website" class="form-control">
            </div>
          </div>
          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="required">Start Date</label>
              <input type="date" name="startDate" class="form-control">
            </div>
            <div class="col-md-6 mb-3">
              <label class="required">End Date</label>
              <input type="date" name="endDate" class="form-control">
            </div>


          </div>
          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="required">Department</label>
              <select name="department" class="custom-select d-block w-100">
                <option value="">Choose...</option>
                <option>CSE</option>
                <option>ISE</option>
                <option>ECE</option>
                <option>TCE</option>
                <option>EEE</option>
                <option>CIV</option>
                <option>MECH</option>
                <option>MBA</option>
                <option>MCA</option>
                <option>Basic Sciences</option>
                <option>College Level</option>
              </select>
              <div class="invalid-feedback">
                Please select a valid type.
              </div>
            </div>
            <div class="col-md-6 mb-3">
              <label class="required">Semester</label>
              <select name="sem" class="custom-select d-block w-100">
                <option value="">Choose...</option>
                <option>I Sem</option>
                <option>II Sem</option>
                <option>III Sem</option>
                <option>IV Sem</option>
                <option>V Sem</option>
                <option>VI Sem</option>
                <option>VII Sem</option>
                <option>VIII Sem</option>
                <option>All sememster</option>
              </select>
              <div class="invalid-feedback">
                Please select a valid type.
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6 mb-3">
              <label>Participant Numbers</label>
              <input type="number" name="participantNo" class="form-control">
            </div>
            <div class="col-md-6 mb-3">
              <label class="required" for="type">COE</label>
              <%- include ("../partials/coe") %>
            </div>
          </div>

          <label>Club Description</label><br>

          <div id="editor">
            <p>This is the editor content.</p>
          </div>
          <div class="submit-button"><button class="btn btn-primary btn-lg btn-block buttons" type="submit">
              Submit</button>
          </div>
        </div>
      </form>



    </section>

  </div>

  <!-- Footer -->


  <%- include ("../partials/footer") %>
    <!-- JavaScript for ckeditor -->

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <script src="http://malsup.github.com/jquery.form.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.0/axios.min.js"
      integrity="sha512-DZqqY3PiOvTP9HkjIWgjO6ouCbq+dxqWoJZ/Q+zPYNHmlnI2dQnbJ5bxAHpAMw+LXRm4D72EIRXzvcHQtE8/VQ=="
      crossorigin="anonymous"></script>

    <script>
      CKEDITOR.replace('editor');
      const element = CKEDITOR.document.getById('editor');

      function submitForm(e) {
        // e.preventDefault()
        var formData = new FormData(clubActivitiesForm);
        const description = element.getText();
        console.log(description);
        formData.append("description", description)
        if (formData.get("clubName") === "others") {
          formData.set("clubName", document.querySelector(".other-text").value)
        } else {
          formData.set("clubName", document.querySelector("select[name='clubName']").value)
        }
        var object = {};
        let flag = true;
        formData.forEach(function (value, key) {
          object[key] = value;
          if (value == "")
            flag = false;
        });
        if (flag) {
          object.filterDate = new Date();
          let day = object.filterDate.getDate();
          let month = object.filterDate.getMonth();
          let year = object.filterDate.getFullYear();
          if (day <= 5) {
            day = 30;
            month = month == 0 ? 11 : month - 1;
            if (month == 11) {
              year--;
            }
          } else {
            day = 30;
          }
          month++;
          object.filterDate = year.toString() + "-" + month.toString() + "-" + day.toString();
          var json = JSON.stringify(object);


          fetch("/faculty/clubActivities", {
            method: "POST",
            headers: {
              'Content-Type': 'application/json'
            },
            body: json
          })
        } else {
          alert('Please fill required fields')
        }

      }

      clubActivitiesForm.addEventListener('submit', (e) => submitForm(e))
    </script>
    </body>

    </html>